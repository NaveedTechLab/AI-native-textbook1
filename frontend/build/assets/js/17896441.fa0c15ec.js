"use strict";(globalThis.webpackChunkai_native_textbook=globalThis.webpackChunkai_native_textbook||[]).push([[401],{2362:(e,t,a)=>{a.d(t,{A:()=>o});a(6540);var n=a(3003),r=a(4848);function o(e){return(0,r.jsx)(n.A,{...e})}},9941:(e,t,a)=>{a.d(t,{A:()=>p});var n=a(6540),r=a(7325),o=a(4848);const s=({chapterId:e})=>{const[t,a]=(0,n.useState)(!1),[r,s]=(0,n.useState)(!1),[i,l]=(0,n.useState)(null),[c,d]=(0,n.useState)(null);(0,n.useEffect)(()=>{localStorage.getItem("user_token")&&u()},[]);const u=async()=>{try{const e="https://naveed247365-ai-textbook-backend.hf.space/api",t=await fetch(`${e}/auth/profile`,{headers:{Authorization:`Bearer ${localStorage.getItem("user_token")}`}});if(t.ok){const e=await t.json();l(e)}}catch(e){console.error("Error fetching user profile:",e)}};return(0,o.jsx)("div",{className:"personalize-container",style:{margin:"1.5rem 0",padding:"1rem",background:"linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(147, 51, 234, 0.1))",borderRadius:"12px",border:"1px solid rgba(59, 130, 246, 0.3)"},children:i?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"personalize-controls",style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:c?"1rem":"0"},children:[(0,o.jsx)("button",{onClick:t?()=>{d(null),a(!1)}:async()=>{if(!localStorage.getItem("user_token")||!i)return alert("\ud83d\udd10 Please login to use Personalization features.\n\nGo to Login page to access this feature."),void(window.location.href="/login");s(!0);try{const t=document.querySelector("article.theme-doc-markdown"),n=t?t.innerText.substring(0,1e4):"",r="https://naveed247365-ai-textbook-backend.hf.space/api",o=await fetch(`${r}/personalization/adapt`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("user_token")}`},body:JSON.stringify({content:n,user_profile:i,chapter_id:e})});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const s=await o.json();console.log("Personalization API response:",s),console.log("Original content length:",n.length),console.log("Personalized content length:",s.personalized_content.length),console.log("Adaptation details:",s.adaptation_details),d(s.personalized_content),a(!0)}catch(t){console.error("Error personalizing content:",t),alert("Failed to personalize content. Please try again.")}finally{s(!1)}},disabled:r,style:{padding:"0.5rem 1.5rem",backgroundColor:t?"#ef4444":"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:r?"wait":"pointer",fontWeight:"600",fontSize:"0.95rem",transition:"all 0.3s ease"},children:r?"\u23f3 Processing...":t?"\ud83d\udd04 Reset to Original":"\u2728 Personalize for My Background"}),(0,o.jsx)("div",{className:"user-profile-info",children:(0,o.jsxs)("small",{style:{color:"#64748b",fontWeight:"500"},children:[i.software_background&&`\ud83d\udcbb ${i.software_background}`,i.software_background&&i.hardware_background&&" \u2022 ",i.hardware_background&&`\ud83d\udd27 ${i.hardware_background}`]})})]}),c&&(0,o.jsxs)("div",{className:"personalized-roadmap",style:{marginTop:"1rem",padding:"1.5rem",background:"rgba(255, 255, 255, 0.9)",borderRadius:"8px",border:"2px solid #3b82f6"},children:[(0,o.jsx)("h3",{style:{color:"#1e40af",marginTop:0,fontSize:"1.3rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:"\ud83c\udfaf Your Personalized Learning Roadmap"}),(0,o.jsx)("div",{style:{whiteSpace:"pre-wrap",lineHeight:"1.7",color:"#334155",fontSize:"0.95rem"},children:c})]})]}):(0,o.jsx)("div",{className:"personalize-prompt",style:{textAlign:"center"},children:(0,o.jsx)("p",{style:{margin:0},children:(0,o.jsxs)("small",{style:{color:"#64748b"},children:["\ud83d\udd12 ",(0,o.jsx)("a",{href:"/login",style:{color:"#3b82f6",fontWeight:"600"},children:"Log in"})," or ",(0,o.jsx)("a",{href:"/signup",style:{color:"#3b82f6",fontWeight:"600"},children:"sign up"})," to get personalized content tailored to your software & hardware background"]})})})})};const i=function(e,t){const[a,r]=(0,n.useState)(!1),[o,s]=(0,n.useState)(""),[i,l]=(0,n.useState)(""),[c,d]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[m,g]=(0,n.useState)(!1),[p,f]=(0,n.useState)(null),b=()=>function(){const e=["article.theme-doc-markdown",'article[role="main"]',"main article","div.theme-doc-markdown","div.markdown",".docMainContainer article","main"];let t=null;for(const r of e)if(t=document.querySelector(r),t){console.log("Found article element with selector:",r);break}if(!t)return console.warn("Article element not found with any selector"),"";const a=t.cloneNode(!0);[".theme-doc-breadcrumbs",".theme-doc-toc-mobile",".pagination-nav","nav","aside",".theme-code-block","button",".admonition"].forEach(e=>{a.querySelectorAll(e).forEach(e=>e.remove())});let n=a.innerText||a.textContent||"";return n=n.trim().replace(/\n\s*\n\s*\n/g,"\n\n"),n}(),x=async e=>await async function(e){const t=(new TextEncoder).encode(e),a=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(a)).map(e=>e.toString(16).padStart(2,"0")).join("")}(e),w=async()=>{if(t)if(e)if(!o||u){d(!0),h("");try{const a=b();if(!a||a.length<50)throw new Error("Unable to extract chapter content. Please refresh the page.");l(a);const n=await x(a),o=await async function(e,t,a,n){try{const r=await fetch("https://naveed247365-ai-textbook-backend.hf.space/api/translate/urdu",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({chapter_id:e,content:t,content_hash:a})}),o=await r.json();if(200===r.status)return{translatedContent:o.translated_content,cached:o.cached,translationId:o.translation_id};if(401===r.status)throw new Error("Authentication required. Please log in to translate content.");if(429===r.status){const e=r.headers.get("Retry-After")||"some time";throw new Error(`Translation limit reached. Please try again in ${e} seconds.`)}if(503===r.status)throw new Error("Translation service is temporarily unavailable. Please try again in a few moments.");if(400===r.status)throw new Error(o.detail||"Invalid request. Please refresh the page and try again.");throw new Error(o.detail||`Translation failed with status ${r.status}`)}catch(u){if(u instanceof TypeError&&u.message.includes("fetch"))throw new Error("Unable to connect to translation service. Please check your internet connection.");if(u.message.includes("Authentication")||u.message.includes("limit")||u.message.includes("unavailable")||u.message.includes("Invalid"))throw u;throw console.error("Translation API error:",u),new Error("An unexpected error occurred during translation. Please try again.")}}(e,a,n,t);s(o.translatedContent),g(o.cached),f(o.translationId||o.translation_id),r(!0),h(""),console.log("Translation "+(o.cached?"loaded from cache":"generated"),{translationId:o.translationId}),"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent("translationChanged",{detail:{content:o.translatedContent,isUrdu:!0}}))}catch(a){console.error("Translation error:",a),h(a.message||"Translation failed. Please try again."),r(!1)}finally{d(!1)}}else r(!0);else h("Chapter ID not found");else h("Please log in to translate content")};return{isUrdu:a,urduContent:o,originalContent:i,loading:c,error:u,cached:m,translationId:p,handleTranslate:w,handleToggle:()=>{if(!o)return void w();const e=!a;r(e),h(""),"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent("translationChanged",{detail:{content:e?o:i,isUrdu:e}}))},handleReset:()=>{r(!1),s(""),l(""),h(""),g(!1)},extractContent:b,computeHash:x}},l={"urdu-translation-container":"urdu-translation-container_DDNb","urdu-translation-button":"urdu-translation-button_zh66","urdu-active":"urdu-active_mOpJ",disabled:"disabled_izxz",translating:"translating_L37S","translation-loading":"translation-loading_Y5vp",spinner:"spinner_Y6VQ",rotate:"rotate_naj9","loading-text":"loading-text_vBWh","translation-cache-indicator":"translation-cache-indicator_BMXM","cache-icon":"cache-icon_ahHJ","cache-text":"cache-text_qcsS","translation-error":"translation-error_Bikc","error-icon":"error-icon_g7E6","error-text":"error-text_AC9L","retry-button":"retry-button_eOAL","translation-auth-prompt":"translation-auth-prompt_raFg","auth-icon":"auth-icon_qMNj","auth-text":"auth-text_OhLN","auth-link":"auth-link_yTNn","translation-info":"translation-info_NAxN","urdu-content":"urdu-content_P6kR","feedback-button":"feedback-button_jBm3","button-icon":"button-icon_llyG","modal-overlay":"modal-overlay_ji9P",fadeIn:"fadeIn_ahag","modal-content":"modal-content_DR6o",slideUp:"slideUp_RELG","modal-header":"modal-header_Xe32","modal-close":"modal-close_g78E","feedback-form":"feedback-form_fIby","form-label":"form-label_NGaK","form-textarea":"form-textarea_OcAx","char-count":"char-count_Gheo","success-message":"success-message_yfXl","error-message":"error-message_lYpH","modal-actions":"modal-actions_ZEGa","modal-button":"modal-button_u4pE","button-primary":"button-primary_hEmR","button-secondary":"button-secondary_xhqs"},c=({translationId:e,onFeedbackSubmit:t})=>{const[a,r]=(0,n.useState)(!1),[s,i]=(0,n.useState)(""),[c,d]=(0,n.useState)(!1),[u,h]=(0,n.useState)(null),m=()=>{r(!1),i(""),h(null)};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("button",{className:`${l["translation-button"]} ${l["feedback-button"]}`,onClick:()=>{r(!0),h(null)},title:"Report translation quality issue",children:[(0,o.jsx)("span",{className:l["button-icon"],children:"\u26a0\ufe0f"}),"Report Issue"]}),a&&(0,o.jsx)("div",{className:l["modal-overlay"],onClick:m,children:(0,o.jsxs)("div",{className:l["modal-content"],onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)("div",{className:l["modal-header"],children:[(0,o.jsx)("h3",{children:"Report Translation Issue"}),(0,o.jsx)("button",{className:l["modal-close"],onClick:m,"aria-label":"Close modal",children:"\xd7"})]}),(0,o.jsxs)("form",{onSubmit:async a=>{if(a.preventDefault(),s.trim().length<10)alert("Please provide at least 10 characters describing the issue.");else{d(!0),h(null);try{const a=localStorage.getItem("authToken");if(!a)throw new Error("Authentication required. Please login.");const n=await fetch("/api/translate/feedback",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({translation_id:e,issue_description:s.trim()})});if(!n.ok){const e=await n.json();throw new Error(e.detail||"Failed to submit feedback")}const r=await n.json();console.log("\u2705 Feedback submitted:",r),h("success"),i(""),t&&t(r),setTimeout(()=>{m()},2e3)}catch(n){console.error("\u274c Feedback submission failed:",n),h("error")}finally{d(!1)}}},className:l["feedback-form"],children:[(0,o.jsx)("label",{htmlFor:"issue-description",className:l["form-label"],children:'Describe the issue (e.g., "Technical term incorrectly translated"):'}),(0,o.jsx)("textarea",{id:"issue-description",className:l["form-textarea"],value:s,onChange:e=>i(e.target.value),placeholder:"Example: The term 'ROS2' was translated to Urdu, but it should remain in English as per technical guidelines.",rows:6,minLength:10,maxLength:2e3,required:!0,disabled:c||"success"===u}),(0,o.jsxs)("p",{className:l["char-count"],children:[s.length," / 2000 characters"]}),"success"===u&&(0,o.jsx)("div",{className:l["success-message"],children:"\u2705 Thank you! Your feedback has been submitted successfully."}),"error"===u&&(0,o.jsx)("div",{className:l["error-message"],children:"\u274c Failed to submit feedback. Please try again."}),(0,o.jsxs)("div",{className:l["modal-actions"],children:[(0,o.jsx)("button",{type:"button",className:`${l["modal-button"]} ${l["button-secondary"]}`,onClick:m,disabled:c,children:"Cancel"}),(0,o.jsx)("button",{type:"submit",className:`${l["modal-button"]} ${l["button-primary"]}`,disabled:c||"success"===u,children:c?"Submitting...":"Submit Feedback"})]})]})]})})]})},d=({chapterId:e})=>{console.log("UrduTranslationButton rendered with chapterId:",e);const t="undefined"!=typeof window?localStorage.getItem("user_token"):null,a="undefined"!=typeof window?localStorage.getItem("user_email"):null;console.log("Auth status:",{authToken:!!t,userEmail:!!a});const{isUrdu:r,loading:s,error:l,cached:d,translationId:u,handleTranslate:h,handleToggle:m}=i(e,t);(0,n.useEffect)(()=>{r&&!s&&console.log("Switched to Urdu view")},[r,s]);const g=!!t&&!!a;return(0,o.jsxs)("div",{style:{padding:"1rem",border:"2px solid #10b981",borderRadius:"8px",marginBottom:"1rem",backgroundColor:"#f0fdf4"},children:[(0,o.jsx)("button",{onClick:()=>{g?m():window.location.href="/signup"},disabled:s,style:{padding:"0.75rem 1.5rem",backgroundColor:s?"#9ca3af":r?"#3b82f6":"#10b981",color:"white",border:"none",borderRadius:"6px",cursor:s?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"600",opacity:g?1:.6},title:g?r?"Switch back to English":"Translate chapter to Urdu":"Login required for translations",children:s?"\u23f3 Translating...":r?"\ud83c\uddec\ud83c\udde7 View in English":"\ud83c\uddf5\ud83c\uddf0 Translate to Urdu"}),s&&(0,o.jsxs)("div",{className:"translation-loading",children:[(0,o.jsx)("span",{className:"spinner",children:"\u25cc"}),(0,o.jsx)("span",{className:"loading-text",children:"Translating content... estimated 8-10 seconds"})]}),r&&d&&!s&&(0,o.jsxs)("div",{className:"translation-cache-indicator",children:[(0,o.jsx)("span",{className:"cache-icon",children:"\u26a1"}),(0,o.jsx)("span",{className:"cache-text",children:"Loaded from cache"})]}),l&&(0,o.jsxs)("div",{className:"translation-error",children:[(0,o.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,o.jsx)("span",{className:"error-text",children:l}),(0,o.jsx)("button",{className:"retry-button",onClick:h,children:"Retry"})]}),!g&&(0,o.jsxs)("div",{className:"translation-auth-prompt",children:[(0,o.jsx)("span",{className:"auth-icon",children:"\ud83d\udd10"}),(0,o.jsxs)("span",{className:"auth-text",children:[(0,o.jsx)("a",{href:"/signup",className:"auth-link",children:"Sign up"})," or ",(0,o.jsx)("a",{href:"/login",className:"auth-link",children:"login"})," to translate content"]})]}),r&&!s&&g&&u&&(0,o.jsx)(c,{translationId:u,onFeedbackSubmit:e=>{console.log("Feedback submitted:",e)}}),g&&!l&&(0,o.jsx)("div",{className:"translation-info",children:(0,o.jsx)("small",{children:r?"\ud83d\udcd6 Displaying content in Urdu (\u0627\u0631\u062f\u0648 \u0645\u06cc\u06ba)":"\ud83d\udcd6 Content available in English"})})]})};function u(){const[e,t]=(0,n.useState)(0);return(0,n.useEffect)(()=>{const e=()=>{requestAnimationFrame(()=>{const e=window.innerHeight,a=document.documentElement.scrollHeight,n=window.scrollY/(a-e)*100;t(Math.min(100,Math.max(0,n)))})};return window.addEventListener("scroll",e),e(),()=>window.removeEventListener("scroll",e)},[]),(0,o.jsx)("div",{className:"reading-progress-container",children:(0,o.jsx)("div",{className:"reading-progress-bar",style:{width:`${e}%`},role:"progressbar","aria-valuenow":Math.round(e),"aria-valuemin":"0","aria-valuemax":"100","aria-label":"Reading progress"})})}var h=a(8774),m=a(542);function g(){const{metadata:e}=(0,m.u)(),{previous:t,next:a}=e;return t||a?(0,o.jsx)("nav",{className:"chapter-navigation","aria-label":"Chapter navigation",children:(0,o.jsxs)("div",{className:"chapter-nav-container",children:[t&&(0,o.jsxs)(h.A,{to:t.permalink,className:"chapter-nav-link chapter-nav-prev",children:[(0,o.jsx)("span",{className:"chapter-nav-arrow",children:"\u2190"}),(0,o.jsxs)("div",{className:"chapter-nav-content",children:[(0,o.jsx)("span",{className:"chapter-nav-label",children:"Previous"}),(0,o.jsx)("span",{className:"chapter-nav-title",children:t.title})]})]}),a&&(0,o.jsxs)(h.A,{to:a.permalink,className:"chapter-nav-link chapter-nav-next",children:[(0,o.jsxs)("div",{className:"chapter-nav-content",children:[(0,o.jsx)("span",{className:"chapter-nav-label",children:"Next"}),(0,o.jsx)("span",{className:"chapter-nav-title",children:a.title})]}),(0,o.jsx)("span",{className:"chapter-nav-arrow",children:"\u2192"})]})]})}):null}function p(e){const{frontMatter:t,metadata:a}=(0,m.u)(),i=t.chapter_id||a.id,[l,c]=(0,n.useState)(null),[h,p]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{const e=e=>{console.log("Translation event received:",e.detail),c(e.detail.content),p(e.detail.isUrdu)};return window.addEventListener("translationChanged",e),()=>window.removeEventListener("translationChanged",e)},[]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u,{}),i&&(0,o.jsxs)("div",{style:{marginBottom:"2rem",display:"flex",gap:"1rem",flexWrap:"wrap"},children:[(0,o.jsx)(s,{chapterId:i}),(0,o.jsx)(d,{chapterId:i})]}),h&&l?(0,o.jsx)("div",{style:{direction:"rtl",textAlign:"right",fontFamily:"'Jameel Noori Nastaleeq', 'Noto Nastaliq Urdu', serif",lineHeight:"2",fontSize:"1.1rem",whiteSpace:"pre-wrap",padding:"1rem",backgroundColor:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},children:l}):(0,o.jsx)(r.A,{...e}),(0,o.jsx)(g,{})]})}}}]);