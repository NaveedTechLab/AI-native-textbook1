"use strict";(globalThis.webpackChunkai_native_textbook=globalThis.webpackChunkai_native_textbook||[]).push([[401],{2362:(e,t,a)=>{a.d(t,{A:()=>s});a(6540);var n=a(3003),r=a(4848);function s(e){return(0,r.jsx)(n.A,{...e})}},9941:(e,t,a)=>{a.d(t,{A:()=>f});var n=a(6540),r=a(7325),s=a(4848);const o="undefined"!=typeof window?"https://naveed247365-ai-textbook-backend.hf.space/api":"http://localhost:8001/api",i=({chapterId:e})=>{const[t,a]=(0,n.useState)(!1),[r,i]=(0,n.useState)(!1),[l,c]=(0,n.useState)(null),[d,u]=(0,n.useState)(null),[h,m]=(0,n.useState)(!0),[p,g]=(0,n.useState)(null);(0,n.useEffect)(()=>{localStorage.getItem("user_token")?f():m(!1);const e=()=>{localStorage.getItem("user_token")?f():(c(null),m(!1))};return window.addEventListener("authChange",e),()=>window.removeEventListener("authChange",e)},[]);const f=async()=>{m(!0);try{const e=await fetch(`${o}/auth/profile`,{headers:{Authorization:`Bearer ${localStorage.getItem("user_token")}`}});if(e.ok){const t=await e.json();c(t)}else 401===e.status&&(localStorage.removeItem("user_token"),localStorage.removeItem("user_email"),c(null))}catch(p){console.error("Error fetching user profile:",p)}finally{m(!1)}};return(0,s.jsx)("div",{className:"personalize-container",children:l?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"personalize-controls",style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap",marginBottom:d?"1rem":"0"},children:[(0,s.jsx)("button",{onClick:t?()=>{u(null),a(!1)}:async()=>{if(!localStorage.getItem("user_token")||!l)return alert("\ud83d\udd10 Please login to use Personalization features.\n\nGo to Login page to access this feature."),void(window.location.href="/login");if(l.software_background||l.hardware_background){i(!0),g(null);try{const t=document.querySelector("article.theme-doc-markdown"),n=t?t.innerText.substring(0,1e4):"",r=await fetch(`${o}/personalization/adapt`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("user_token")}`},body:JSON.stringify({content:n,user_profile:l,chapter_id:e})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const s=await r.json();console.log("Personalization API response:",s),console.log("Original content length:",n.length),console.log("Personalized content length:",s.personalized_content.length),console.log("Adaptation details:",s.adaptation_details),u(s.personalized_content),a(!0)}catch(p){console.error("Error personalizing content:",p),alert("Failed to personalize content. Please try again.")}finally{i(!1)}}else alert("\ud83d\udcdd Please complete your profile with software and hardware background to use personalization.\n\nThis helps us tailor content to your experience level.")},disabled:r,className:"personalize-btn "+(t?"reset":""),children:r?"\u23f3 Processing...":t?"\ud83d\udd04 Reset to Original":"\u2728 Personalize for My Background"}),(0,s.jsx)("div",{className:"user-profile-info",children:(0,s.jsxs)("small",{children:[l.software_background&&`\ud83d\udcbb ${l.software_background}`,l.software_background&&l.hardware_background&&" \u2022 ",l.hardware_background&&`\ud83d\udd27 ${l.hardware_background}`]})})]}),d&&(0,s.jsxs)("div",{className:"personalized-roadmap",children:[(0,s.jsx)("h3",{children:"\ud83c\udfaf Your Personalized Learning Roadmap"}),(0,s.jsx)("div",{children:d})]})]}):(0,s.jsx)("div",{className:"personalize-prompt",children:(0,s.jsx)("p",{style:{margin:0},children:(0,s.jsxs)("small",{children:["\ud83d\udd12 ",(0,s.jsx)("a",{href:"/login",children:"Log in"})," or ",(0,s.jsx)("a",{href:"/signup",children:"sign up"})," to get personalized content tailored to your software & hardware background"]})})})})};const l=function(e,t){const[a,r]=(0,n.useState)(!1),[s,o]=(0,n.useState)(""),[i,l]=(0,n.useState)(""),[c,d]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[m,p]=(0,n.useState)(!1),[g,f]=(0,n.useState)(null),b=()=>function(){const e=["article.theme-doc-markdown",'article[role="main"]',"main article","div.theme-doc-markdown","div.markdown",".docMainContainer article","main"];let t=null;for(const r of e)if(t=document.querySelector(r),t){console.log("Found article element with selector:",r);break}if(!t)return console.warn("Article element not found with any selector"),"";const a=t.cloneNode(!0);[".theme-doc-breadcrumbs",".theme-doc-toc-mobile",".pagination-nav","nav","aside",".theme-code-block","button",".admonition"].forEach(e=>{a.querySelectorAll(e).forEach(e=>e.remove())});let n=a.innerText||a.textContent||"";return n=n.trim().replace(/\n\s*\n\s*\n/g,"\n\n"),n}(),x=async e=>await async function(e){const t=(new TextEncoder).encode(e),a=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(a)).map(e=>e.toString(16).padStart(2,"0")).join("")}(e),w=async()=>{if(t)if(e)if(!s||u){d(!0),h("");try{const a=b();if(!a||a.length<50)throw new Error("Unable to extract chapter content. Please refresh the page.");l(a);const n=await x(a),s=await async function(e,t,a,n){try{const r=await fetch("https://naveed247365-ai-textbook-backend.hf.space/api/translate/urdu",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({chapter_id:e,content:t,content_hash:a})}),s=await r.json();if(200===r.status)return{translatedContent:s.translated_content,cached:s.cached,translationId:s.translation_id};if(401===r.status)throw new Error("Authentication required. Please log in to translate content.");if(429===r.status){const e=r.headers.get("Retry-After")||"some time";throw new Error(`Translation limit reached. Please try again in ${e} seconds.`)}if(503===r.status)throw new Error("Translation service is temporarily unavailable. Please try again in a few moments.");if(400===r.status)throw new Error(s.detail||"Invalid request. Please refresh the page and try again.");throw new Error(s.detail||`Translation failed with status ${r.status}`)}catch(u){if(u instanceof TypeError&&u.message.includes("fetch"))throw new Error("Unable to connect to translation service. Please check your internet connection.");if(u.message.includes("Authentication")||u.message.includes("limit")||u.message.includes("unavailable")||u.message.includes("Invalid"))throw u;throw console.error("Translation API error:",u),new Error("An unexpected error occurred during translation. Please try again.")}}(e,a,n,t);o(s.translatedContent),p(s.cached),f(s.translationId||s.translation_id),r(!0),h(""),console.log("Translation "+(s.cached?"loaded from cache":"generated"),{translationId:s.translationId}),"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent("translationChanged",{detail:{content:s.translatedContent,isUrdu:!0}}))}catch(a){console.error("Translation error:",a),h(a.message||"Translation failed. Please try again."),r(!1)}finally{d(!1)}}else r(!0);else h("Chapter ID not found");else h("Please log in to translate content")};return{isUrdu:a,urduContent:s,originalContent:i,loading:c,error:u,cached:m,translationId:g,handleTranslate:w,handleToggle:()=>{if(!s)return void w();const e=!a;r(e),h(""),"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent("translationChanged",{detail:{content:e?s:i,isUrdu:e}}))},handleReset:()=>{r(!1),o(""),l(""),h(""),p(!1)},extractContent:b,computeHash:x}},c={"urdu-translation-container":"urdu-translation-container_DDNb","urdu-translation-button":"urdu-translation-button_zh66","urdu-active":"urdu-active_mOpJ",disabled:"disabled_izxz",translating:"translating_L37S","translation-loading":"translation-loading_Y5vp",spinner:"spinner_Y6VQ",rotate:"rotate_naj9","loading-text":"loading-text_vBWh","translation-cache-indicator":"translation-cache-indicator_BMXM","cache-icon":"cache-icon_ahHJ","cache-text":"cache-text_qcsS","translation-error":"translation-error_Bikc","error-icon":"error-icon_g7E6","error-text":"error-text_AC9L","retry-button":"retry-button_eOAL","translation-auth-prompt":"translation-auth-prompt_raFg","auth-icon":"auth-icon_qMNj","auth-text":"auth-text_OhLN","auth-link":"auth-link_yTNn","translation-info":"translation-info_NAxN","urdu-content":"urdu-content_P6kR","feedback-button":"feedback-button_jBm3","button-icon":"button-icon_llyG","modal-overlay":"modal-overlay_ji9P",fadeIn:"fadeIn_ahag","modal-content":"modal-content_DR6o",slideUp:"slideUp_RELG","modal-header":"modal-header_Xe32","modal-close":"modal-close_g78E","feedback-form":"feedback-form_fIby","form-label":"form-label_NGaK","form-textarea":"form-textarea_OcAx","char-count":"char-count_Gheo","success-message":"success-message_yfXl","error-message":"error-message_lYpH","modal-actions":"modal-actions_ZEGa","modal-button":"modal-button_u4pE","button-primary":"button-primary_hEmR","button-secondary":"button-secondary_xhqs"},d=({translationId:e,onFeedbackSubmit:t})=>{const[a,r]=(0,n.useState)(!1),[o,i]=(0,n.useState)(""),[l,d]=(0,n.useState)(!1),[u,h]=(0,n.useState)(null),m=()=>{r(!1),i(""),h(null)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{className:`${c["translation-button"]} ${c["feedback-button"]}`,onClick:()=>{r(!0),h(null)},title:"Report translation quality issue",children:[(0,s.jsx)("span",{className:c["button-icon"],children:"\u26a0\ufe0f"}),"Report Issue"]}),a&&(0,s.jsx)("div",{className:c["modal-overlay"],onClick:m,children:(0,s.jsxs)("div",{className:c["modal-content"],onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:c["modal-header"],children:[(0,s.jsx)("h3",{children:"Report Translation Issue"}),(0,s.jsx)("button",{className:c["modal-close"],onClick:m,"aria-label":"Close modal",children:"\xd7"})]}),(0,s.jsxs)("form",{onSubmit:async a=>{if(a.preventDefault(),o.trim().length<10)alert("Please provide at least 10 characters describing the issue.");else{d(!0),h(null);try{const a=localStorage.getItem("authToken");if(!a)throw new Error("Authentication required. Please login.");const n=await fetch("/api/translate/feedback",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({translation_id:e,issue_description:o.trim()})});if(!n.ok){const e=await n.json();throw new Error(e.detail||"Failed to submit feedback")}const r=await n.json();console.log("\u2705 Feedback submitted:",r),h("success"),i(""),t&&t(r),setTimeout(()=>{m()},2e3)}catch(n){console.error("\u274c Feedback submission failed:",n),h("error")}finally{d(!1)}}},className:c["feedback-form"],children:[(0,s.jsx)("label",{htmlFor:"issue-description",className:c["form-label"],children:'Describe the issue (e.g., "Technical term incorrectly translated"):'}),(0,s.jsx)("textarea",{id:"issue-description",className:c["form-textarea"],value:o,onChange:e=>i(e.target.value),placeholder:"Example: The term 'ROS2' was translated to Urdu, but it should remain in English as per technical guidelines.",rows:6,minLength:10,maxLength:2e3,required:!0,disabled:l||"success"===u}),(0,s.jsxs)("p",{className:c["char-count"],children:[o.length," / 2000 characters"]}),"success"===u&&(0,s.jsx)("div",{className:c["success-message"],children:"\u2705 Thank you! Your feedback has been submitted successfully."}),"error"===u&&(0,s.jsx)("div",{className:c["error-message"],children:"\u274c Failed to submit feedback. Please try again."}),(0,s.jsxs)("div",{className:c["modal-actions"],children:[(0,s.jsx)("button",{type:"button",className:`${c["modal-button"]} ${c["button-secondary"]}`,onClick:m,disabled:l,children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:`${c["modal-button"]} ${c["button-primary"]}`,disabled:l||"success"===u,children:l?"Submitting...":"Submit Feedback"})]})]})]})})]})},u=({chapterId:e})=>{console.log("UrduTranslationButton rendered with chapterId:",e);const t="undefined"!=typeof window?localStorage.getItem("user_token"):null,a="undefined"!=typeof window?localStorage.getItem("user_email"):null;console.log("Auth status:",{authToken:!!t,userEmail:!!a});const{isUrdu:r,loading:o,error:i,cached:c,translationId:u,handleTranslate:h,handleToggle:m}=l(e,t);(0,n.useEffect)(()=>{r&&!o&&console.log("Switched to Urdu view")},[r,o]);const p=!!t&&!!a;return(0,s.jsxs)("div",{className:"translation-container",children:[(0,s.jsx)("button",{onClick:()=>{p?m():window.location.href="/signup"},disabled:o,className:"translation-btn "+(r?"urdu-active":""),style:{opacity:p?1:.6},title:p?r?"Switch back to English":"Translate chapter to Urdu":"Login required for translations",children:o?"\u23f3 Translating...":r?"\ud83c\uddec\ud83c\udde7 View in English":"\ud83c\uddf5\ud83c\uddf0 Translate to Urdu"}),o&&(0,s.jsxs)("div",{className:"translation-loading",children:[(0,s.jsx)("span",{className:"spinner",children:"\u25cc"}),(0,s.jsx)("span",{children:"Translating content... estimated 8-10 seconds"})]}),r&&c&&!o&&(0,s.jsxs)("div",{className:"translation-cache-indicator",children:[(0,s.jsx)("span",{children:"\u26a1"}),(0,s.jsx)("span",{children:"Loaded from cache"})]}),i&&(0,s.jsxs)("div",{className:"translation-error",children:[(0,s.jsx)("span",{children:"\u26a0\ufe0f"}),(0,s.jsx)("span",{children:i}),(0,s.jsx)("button",{className:"retry-button",onClick:h,children:"Retry"})]}),!p&&(0,s.jsxs)("div",{className:"translation-auth-prompt",children:[(0,s.jsx)("span",{children:"\ud83d\udd10"}),(0,s.jsxs)("span",{children:[(0,s.jsx)("a",{href:"/signup",className:"auth-link",children:"Sign up"})," or ",(0,s.jsx)("a",{href:"/login",className:"auth-link",children:"login"})," to translate content"]})]}),r&&!o&&p&&u&&(0,s.jsx)(d,{translationId:u,onFeedbackSubmit:e=>{console.log("Feedback submitted:",e)}}),p&&!i&&(0,s.jsx)("div",{className:"translation-info",children:(0,s.jsx)("small",{children:r?"\ud83d\udcd6 Displaying content in Urdu (\u0627\u0631\u062f\u0648 \u0645\u06cc\u06ba)":"\ud83d\udcd6 Content available in English"})})]})};function h(){const[e,t]=(0,n.useState)(0);return(0,n.useEffect)(()=>{const e=()=>{requestAnimationFrame(()=>{const e=window.innerHeight,a=document.documentElement.scrollHeight,n=window.scrollY/(a-e)*100;t(Math.min(100,Math.max(0,n)))})};return window.addEventListener("scroll",e),e(),()=>window.removeEventListener("scroll",e)},[]),(0,s.jsx)("div",{className:"reading-progress-container",children:(0,s.jsx)("div",{className:"reading-progress-bar",style:{width:`${e}%`},role:"progressbar","aria-valuenow":Math.round(e),"aria-valuemin":"0","aria-valuemax":"100","aria-label":"Reading progress"})})}var m=a(8774),p=a(542);function g(){const{metadata:e}=(0,p.u)(),{previous:t,next:a}=e;return t||a?(0,s.jsx)("nav",{className:"chapter-navigation","aria-label":"Chapter navigation",children:(0,s.jsxs)("div",{className:"chapter-nav-container",children:[t&&(0,s.jsxs)(m.A,{to:t.permalink,className:"chapter-nav-link chapter-nav-prev",children:[(0,s.jsx)("span",{className:"chapter-nav-arrow",children:"\u2190"}),(0,s.jsxs)("div",{className:"chapter-nav-content",children:[(0,s.jsx)("span",{className:"chapter-nav-label",children:"Previous"}),(0,s.jsx)("span",{className:"chapter-nav-title",children:t.title})]})]}),a&&(0,s.jsxs)(m.A,{to:a.permalink,className:"chapter-nav-link chapter-nav-next",children:[(0,s.jsxs)("div",{className:"chapter-nav-content",children:[(0,s.jsx)("span",{className:"chapter-nav-label",children:"Next"}),(0,s.jsx)("span",{className:"chapter-nav-title",children:a.title})]}),(0,s.jsx)("span",{className:"chapter-nav-arrow",children:"\u2192"})]})]})}):null}function f(e){const{frontMatter:t,metadata:a}=(0,p.u)(),o=t.chapter_id||a.id,[l,c]=(0,n.useState)(null),[d,m]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{const e=e=>{console.log("Translation event received:",e.detail),c(e.detail.content),m(e.detail.isUrdu)};return window.addEventListener("translationChanged",e),()=>window.removeEventListener("translationChanged",e)},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h,{}),o&&(0,s.jsxs)("div",{style:{marginBottom:"2rem",display:"flex",gap:"1rem",flexWrap:"wrap"},children:[(0,s.jsx)(i,{chapterId:o}),(0,s.jsx)(u,{chapterId:o})]}),d&&l?(0,s.jsx)("div",{style:{direction:"rtl",textAlign:"right",fontFamily:"'Jameel Noori Nastaleeq', 'Noto Nastaliq Urdu', serif",lineHeight:"2",fontSize:"1.1rem",whiteSpace:"pre-wrap",padding:"1rem",backgroundColor:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},children:l}):(0,s.jsx)(r.A,{...e}),(0,s.jsx)(g,{})]})}}}]);